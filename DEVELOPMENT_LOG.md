# OpenCode Smart Model Selector å¼€å‘è®°å½•

## é¡¹ç›®æ¦‚è¿°

æ™ºèƒ½æ¨¡å‹è°ƒåº¦ç³»ç»Ÿ - åŸºäºä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ AI æ¨¡å‹ï¼Œæ”¯æŒå¤š Provider è´Ÿè½½å‡è¡¡ã€æ•…éšœè‡ªåŠ¨è½¬ç§»ã€æˆæœ¬ä¼˜åŒ–ã€‚

RV|**å½“å‰ç‰ˆæœ¬**: v2.2.1

---

## ä¸¤ä¸ªé¡¹ç›®ç›®å½•çš„ç”¨é€”

| ç›®å½• | ç”¨é€” |
|------|------|
| `/Users/leiyuanwu/LocalProjects/OpenCode/smart-model-selector/` | **æœ¬åœ°è‡ªç”¨å·¥ä½œç›®å½•** - ä¿ç•™éšç§é…ç½® (api_config.json å«å¯†é’¥) |
| `/Users/leiyuanwu/GitHub/opencode-smart-model-selector/` | **GitHub åŒæ­¥ç›®å½•** - å¹²å‡€ç¯å¢ƒå¼€å‘æµ‹è¯•ï¼ŒéªŒè¯ååŒæ­¥ |

### å·¥ä½œæµç¨‹ (é‡è¦)

```
GitHub ç›®å½• (å¹²å‡€ç¯å¢ƒå¼€å‘æµ‹è¯•)
    â†“
å¼€å‘ã€æµ‹è¯•ã€éªŒè¯
    â†“
åŒæ—¶åŒæ­¥åˆ°ï¼š
    â”œâ”€â”€ æœ¬åœ°å·¥ä½œç›®å½• (ä¿ç•™éšç§é…ç½®)
    â””â”€â”€ GitHub ä»“åº“ (å…¬å¼€å‘å¸ƒ)
```

**æ ¸å¿ƒåŸåˆ™**ï¼š
- GitHub ç›®å½•æ˜¯æµ‹è¯•éªŒè¯ç¯å¢ƒ
- éªŒè¯é€šè¿‡åå†åŒæ­¥ä¸¤è¾¹
- æœ¬åœ°å·¥ä½œç›®å½•ä¿ç•™éšç§ä¿¡æ¯
- å‡ºé—®é¢˜å¯ä»æœ¬åœ°å·¥ä½œç›®å½•å›æ»š

---

HR|## æœ¬æ¬¡å¼€å‘å†…å®¹ (2026-02-27 ç¬¬äºŒæ¬¡ä¿®å¤)

### å®¡è®¡é—®é¢˜ä¿®å¤

æ ¹æ®ä»£ç å®¡è®¡æŠ¥å‘Šï¼Œä¿®å¤ä»¥ä¸‹é—®é¢˜ï¼š

#### 1. æµ‹é€Ÿç¼“å­˜ Bug ä¿®å¤ (é«˜ä¼˜å…ˆçº§)

| æ–‡ä»¶ | é—®é¢˜ | ä¿®å¤ |
|------|------|------|
| `smart_model_dispatcher.py` | `_load_cache` æ–¹æ³•ç¼ºå°‘å†å²æ•°æ®èµ‹å€¼ï¼Œå¯¼è‡´çƒ­å¯åŠ¨å¤±æ•ˆ | æ·»åŠ  `self._history = data.get("history", {})` |

#### 2. æµå¼å“åº”æ”¯æŒ (é«˜ä¼˜å…ˆçº§)

| æ–‡ä»¶ | é—®é¢˜ | ä¿®å¤ |
|------|------|------|
| `api_server.py` | Streaming è¯·æ±‚è¿”å› 400 é”™è¯¯ | å®ç° `_stream_response` æ–¹æ³•ï¼Œæ”¯æŒ OpenAI SSE åè®® |

#### 3. Gunicorn å¯åŠ¨è¯´æ˜ (ä¸­ä¼˜å…ˆçº§)

| æ–‡ä»¶ | é—®é¢˜ | ä¿®å¤ |
|------|------|------|
| `README.md` | ç¼ºå°‘ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è¯´æ˜ | æ·»åŠ  `gunicorn -w 4 -k gevent` å¯åŠ¨å‘½ä»¤ |

---

## å†å²å¼€å‘å†…å®¹ (2026-02-27 ç¬¬ä¸€æ¬¡)

### 1. æµ‹è¯•éªŒè¯

- **Python è¯­æ³•æ£€æŸ¥**: æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶è¯­æ³•æ­£ç¡®
- **æ¨¡å—å¯¼å…¥æµ‹è¯•**: version, dual_engine, api_server å‡å¯æ­£å¸¸å¯¼å…¥
- **åŠŸèƒ½è¿è¡Œæµ‹è¯•**: DualEngineManager åˆå§‹åŒ–æˆåŠŸ
- **æ³¨æ„**: é¡¹ç›®æ²¡æœ‰å•å…ƒæµ‹è¯•æ–‡ä»¶

### 2. ä»£ç å®¡æŸ¥ (é€å­—é€å¥)

å‘ç°å¹¶ä¿®å¤ **1 ä¸ª bug**:

| æ–‡ä»¶ | è¡Œå· | é—®é¢˜ | ä¿®å¤ |
|------|------|------|------|
| `dual_engine.py` | 183 | `failure_count_count` â†’ æ‹¼å†™é”™è¯¯ | æ”¹ä¸º `failure_count` |
| `dual_engine.py` | 115 | æ³¨é‡Šè¯¯å¯¼ | "ä¼˜å…ˆä½¿ç”¨åŸç”Ÿå¼•æ“" â†’ "ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰å¼•æ“" |

### 3. æ–‡æ¡£å®Œå–„

**README.md æ›´æ–°**:
- æ–°å¢ 3 ä¸ªæ ¸å¿ƒç‰¹æ€§:
  - ğŸ”€ åŒå¼•æ“å†—ä½™
  - âš¡ ç†”æ–­é™çº§
  - ğŸ“¡ API Server
- æ–°å¢ `op engine custom / native` å‘½ä»¤è¯´æ˜

**README_EN.md æ›´æ–°**:
- æ–°å¢è‹±æ–‡ç‰ˆæ ¸å¿ƒç‰¹æ€§è¯´æ˜

### 4. GitHub Release

- åˆ›å»º v2.2.0 Release
- ä¿®å¤ Release æœªå‘å¸ƒé—®é¢˜

### 1. æµ‹è¯•éªŒè¯

- **Python è¯­æ³•æ£€æŸ¥**: æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶è¯­æ³•æ­£ç¡®
- **æ¨¡å—å¯¼å…¥æµ‹è¯•**: version, dual_engine, api_server å‡å¯æ­£å¸¸å¯¼å…¥
- **åŠŸèƒ½è¿è¡Œæµ‹è¯•**: DualEngineManager åˆå§‹åŒ–æˆåŠŸ
- **æ³¨æ„**: é¡¹ç›®æ²¡æœ‰å•å…ƒæµ‹è¯•æ–‡ä»¶

### 2. ä»£ç å®¡æŸ¥ (é€å­—é€å¥)

å‘ç°å¹¶ä¿®å¤ **1 ä¸ª bug**:

| æ–‡ä»¶ | è¡Œå· | é—®é¢˜ | ä¿®å¤ |
|------|------|------|------|
| `dual_engine.py` | 183 | `failure_count_count` â†’ æ‹¼å†™é”™è¯¯ | æ”¹ä¸º `failure_count` |
| `dual_engine.py` | 115 | æ³¨é‡Šè¯¯å¯¼ | "ä¼˜å…ˆä½¿ç”¨åŸç”Ÿå¼•æ“" â†’ "ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰å¼•æ“" |

### 3. æ–‡æ¡£å®Œå–„

**README.md æ›´æ–°**:
- æ–°å¢ 3 ä¸ªæ ¸å¿ƒç‰¹æ€§:
  - ğŸ”€ åŒå¼•æ“å†—ä½™
  - âš¡ ç†”æ–­é™çº§
  - ğŸ“¡ API Server
- æ–°å¢ `op engine custom / native` å‘½ä»¤è¯´æ˜

**README_EN.md æ›´æ–°**:
- æ–°å¢è‹±æ–‡ç‰ˆæ ¸å¿ƒç‰¹æ€§è¯´æ˜

### 4. GitHub Release

- åˆ›å»º v2.2.0 Release
- ä¿®å¤ Release æœªå‘å¸ƒé—®é¢˜

---

## Git æ“ä½œè®°å½•

### æœ¬æ¬¡æäº¤

| Commit | æè¿° |
|--------|------|
| `fae693a` | docs: æ·»åŠ å¼€å‘è®°å½• DEVELOPMENT_LOG.md |
| `bce5f3a` | docs: æ›´æ–° README - ä¿®å¤æ ¼å¼ |
| `2963e0c` | fix: ä¿®å¤ dual_engine.py æ‹¼å†™é”™è¯¯ + æ›´æ–° README æ–‡æ¡£ |
| `49b9222` | release: v2.2.0 - åŒå¼•æ“æ¶æ„ + ç†”æ–­é™çº§ + å¹¶å‘ä¼˜åŒ– |

### åŒæ­¥å‘½ä»¤

```bash
# åŒæ—¶åŒæ­¥åˆ°æœ¬åœ°ç›®å½• + æ¨é€åˆ° GitHub
rsync -av --exclude='.git' --exclude='__pycache__' --exclude='*.egg-info' --exclude='dist' --exclude='api_config.json' /Users/leiyuanwu/GitHub/opencode-smart-model-selector/ /Users/leiyuanwu/LocalProjects/OpenCode/smart-model-selector/

cd /Users/leiyuanwu/GitHub/opencode-smart-model-selector && git push origin main
```

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æè¿° |
|------|------|------|
| 1.0.0 | 2025-01-01 | åˆå§‹ç‰ˆæœ¬ - æ™ºèƒ½æ¨¡å‹é€‰æ‹© + æ•…éšœè½¬ç§» |
| 2.0.0 | 2025-02-25 | é‡å¤§æ›´æ–°: æ‰‹åŠ¨æŒ‡å®šæ¨¡å‹ > è‡ªåŠ¨æ¨èä¼˜å…ˆçº§, 24h TTL, è¿ç»­3æ¬¡å¤±è´¥è‡ªåŠ¨åˆ‡æ¢, op auto/reset å‘½ä»¤, é•¿æ–‡æœ¬é™çº§ç­–ç•¥, æµ‹é€Ÿè®°å¿†æŒä¹…åŒ– |
| 2.1.0 | 2026-02-26 | æ–°å¢åŠŸèƒ½: API Server æ¨¡å— (OpenAI å…¼å®¹æ¥å£), op api å‘½ä»¤ |
MV|| 2.2.0 | 2026-02-27 | æ–°å¢åŠŸèƒ½: åŒå¼•æ“æ¶æ„, ç†”æ–­é™çº§, å¹¶å‘ä¼˜åŒ–, æµ‹é€Ÿç¼“å­˜4hè¿‡æœŸ, op engine å‘½ä»¤ |
MX|| 2.2.1 | 2026-02-27 | Bugä¿®å¤: æµ‹é€Ÿç¼“å­˜çƒ­å¯åŠ¨, æµå¼å“åº”æ”¯æŒ, Gunicornå¯åŠ¨è¯´æ˜ |

---

## å·²çŸ¥é—®é¢˜

- æš‚æ— å•å…ƒæµ‹è¯•æ–‡ä»¶
- ç½‘ç»œä¸ç¨³å®šæ—¶ GitHub æ¨é€å¯èƒ½å¤±è´¥

---

## å¸¸ç”¨å‘½ä»¤

```bash
# è¿›å…¥ GitHub ç›®å½•
cd /Users/leiyuanwu/GitHub/opencode-smart-model-selector

# è¿›å…¥æœ¬åœ°å·¥ä½œç›®å½•
cd /Users/leiyuanwu/LocalProjects/OpenCode/smart-model-selector

# æµ‹è¯•æ¨¡å—å¯¼å…¥
python3 -c "from dual_engine import DualEngineManager; print(DualEngineManager().get_status())"

# æŸ¥çœ‹ç‰ˆæœ¬
python3 version.py
```

---

WY|*æœ€åæ›´æ–°: 2026-02-27*
